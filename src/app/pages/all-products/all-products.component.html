<!-- Banner -->
<section class="relative left-1/2 right-1/2 -mx-[50vw] w-screen">
  <div
    class="relative py-20 bg-cover bg-center bg-no-repeat h-96"
    [ngStyle]="{ 'background-image': 'url(' + bannerImage + ')' }">
    <div class="absolute inset-0 bg-black/40"></div>
    <div class="relative container mx-auto text-start max-w-7xl">
      <h2 class="text-lg text-white tracking-wide">All Products</h2>
      <h1 class="text-4xl md:text-5xl font-bold text-white mt-2">
        Premium Skincare & Beauty
      </h1>
      <p class="text-white mt-1 max-w-xl">
        Explore our complete collection of authentic skincare, haircare,
        baby care, and wellness products.
      </p>
    </div>
  </div>
</section>

<!-- Features -->
<app-features></app-features>

<!-- Main Section -->
<section class="my-10 px-4 md:px-0">

  <div class="flex flex-col lg:flex-row gap-2 relative">

    <!-- Desktop Filter Sidebar -->
    <div class="hidden lg:block lg:w-72 xl:w-72 shrink-0">
      <app-product-filter
        [filters]="filters"
        (filtersChange)="filters = $event; applyFilters()"
        [hideCategory]="true">
      </app-product-filter>
    </div>

    <!-- Main Content -->
    <div class="w-full lg:flex-1">

      <!-- Header -->
      <app-header
        [title]="'All Products'"
        description="Shop our full range of trusted skincare, haircare, baby care, and wellness products.">
      </app-header>

      <!-- Mobile Filter Trigger -->
      <div class="lg:hidden mb-6">
        <button 
          class="w-full py-2.5 rounded-2xl shadow-xl text-base font-medium bg-primary hover:bg-secondary text-white"
          (click)="showMobileFilter = true">
          Open Filters
        </button>
      </div>

      <!-- Mobile Filter Popup Drawer â€“ NO GRAY BACKGROUND -->
      @if (showMobileFilter) {
                <div
          class="fixed inset-0 bg-black/50 z-50 transition-opacity"
          (click)="closeMobileFilter()">
        </div>
        <div
          class="fixed top-0  right-0 h-full w-[50%]  rounded-lg  z-50  transform transition-transform duration-300 ease-in-out "
          
          [ngClass]="{'translate-x-0': showMobileFilter, 'translate-x-full': !showMobileFilter}">
          
          <app-mobile-filter-drawer
            [isOpen]="showMobileFilter"
            [filters]="filters"
            (filtersChange)="filters = $event; applyFilters()"
            (isOpenChange)="showMobileFilter = $event"
            [hideCategory]="true">
          </app-mobile-filter-drawer>
        </div>
      }

      <!-- Showing Count -->
      <p class="text-gray-600 text-center lg:text-left mb-6">
        Showing
        <span class="text-secondary font-semibold">{{ showingRange }}</span>
        of
        <span class="text-secondary font-semibold">{{ filteredProducts.length }}</span>
        products
      </p>

      <!-- Products Grid -->
          <div class="flex flex-wrap gap-2 justify-center  items-center ">
        @if (currentProducts.length > 0) {
          @for (product of currentProducts; track product.slug) {
            <app-product-cart
              [id]="product.slug"
              [slug]="product.slug"
              [imgUrl]="product.imageUrl"
              [productName]="product.name"
              [productDesc]="product.shortDescription"
              [rating]="product.rating"
              [OPrice]="product.oldPrice"
              [NPrice]="product.price"
              [reviewCount]="product.reviewCount">
            </app-product-cart>
          }
        } @else {
          <div class="col-span-full text-center py-20">
            <p class="text-gray-500 text-xl font-medium">No products found</p>
          </div>
        }
      </div>

      <!-- Pagination -->
      @if (totalPages > 1) {
        <div class="flex flex-wrap justify-center items-center gap-3 mt-10">
          <button
            class="px-4 py-2 bg-primary text-white rounded disabled:opacity-40"
            [disabled]="currentPage === 1"
            (click)="goToPage(currentPage - 1)">
            Previous
          </button>

          @for (page of [].constructor(totalPages); track $index) {
<button

  class="w-10 h-10 rounded-full border"
  [ngClass]="{
    'bg-secondary text-white': currentPage === $index + 1,
    'bg-white': currentPage !== $index + 1
  }"
  (click)="goToPage($index + 1)"
>
  {{ $index + 1 }}
</button>

          }

          <button
            class="px-4 py-2 bg-primary text-white rounded disabled:opacity-40"
            [disabled]="currentPage === totalPages"
            (click)="goToPage(currentPage + 1)">
            Next
          </button>
        </div>
      }
    </div>
  </div>
</section>